<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Create:Ponder</title>
  <style>body{margin: 0;} canvas{position: absolute;display: block;filter: contrast(1.6);z-index: -1;}</style>
  <link rel="stylesheet" href="styles.css" />
  <link rel="icon" href="./assets/page/Dragon_Head_JE1_BE1.png">
  <style>
    .load {
      z-index: 100;
      background-color: #d10000;
      opacity: 1;
      transition: opacity 1s ease-in-out;
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column;
    }
    .loadstate {
      width: 65%;
      margin-top: .6rem;
      padding: .4rem 10px 5px 10px;
      font-weight: bolder;
      transition: all 0.5s ease-in-out;
    }
    .loadinfo {
      color: white;
      font-size: 18px;
    }
    .loadstate .rangebox {
      height: 16px;
      border: 3px solid white;
      margin-top: 5px;
      padding: 3px;
    }
    .loadstate .rangeblock {
      transition: width 0.5s ease-in-out;
      width: 0%;
      height: 100%;
      background-color: white;
    }
    .bugjump {
      width: 70%;
      margin-bottom: 1rem;
    }
  </style>
</head>
<body>
  <link rel="stylesheet" href="./ponder/item.css">
  <section class="load abso"><img class="bugjump" src="./assets/page/bugjump.png"></img></section>
  <script>
    const body = document.body;
    let fileLoaded = 0;
    const loadingDiv = document.querySelector('.load');
    function SNLB(i, range){//setNewLoadBlock
      const loadstate = document.createElement('div');
      loadstate.classList.add('loadstate');
      if (range){
        loadstate.innerHTML = '<h class="loadinfo"></h><div class="rangebox"><div class="rangeblock"></div></div>';
      }else{
        loadstate.innerHTML = '<h class="loadinfo"></h>';
      }
      loadingDiv.appendChild(loadstate);
      const loadinfo = loadstate.querySelector('.loadinfo');
      const rangeblock = loadstate.querySelector('.rangebox .rangeblock') || null;
      loadstate.id = i;
      return {loadstate, loadinfo, rangeblock}
    }
    function loadFile(url, type, range, title=`Loading ${url}...`){
      return new Promise((resolve, reject) => {
      const {loadstate, loadinfo, rangeblock} = SNLB(url, range);
      loadinfo.textContent = title;
      const xhr = new XMLHttpRequest();
      xhr.open('GET', url, true);
      xhr.setRequestHeader('Accept', 'text/plain');
      xhr.responseType = 'text';
      xhr.onprogress = (e) => {
        if (e.lengthComputable && rangeblock) {
          rangeblock.style.width = `${(e.loaded / e.total) * 100}%`;
        }
      }
      xhr.onload = () => {
        if (xhr.readyState === 4) {
          loadstate.style.backgroundColor = '#fff6';
          let data;
          loadinfo.textContent = `${url} loaded successfully! (${xhr.status})`;
          switch (type) {
          case 'js':
            const script = document.createElement('script');  
            script.textContent = xhr.responseText;
            document.body.appendChild(script);
            data = undefined;
            break;
          case 'css':
            const style = document.createElement('style');
            style.textContent = xhr.responseText;
            body.appendChild(style);
            data = undefined;
            break;
          case 'json':
            data = JSON.parse(xhr.responseText);
            break;
          default:
            data = xhr.responseText;
            break;
          }
          resolve(data);
        }else{
          loadinfo.textContent = `Failed to load ${url}!`;
        }
      }
      xhr.onerror = () => {
        loadinfo.textContent = `Failed to load ${url}!`;
      }
      xhr.send();
      });
    }
    const navLang = navigator.language;
  </script>
  <script type="module">
    async function loadTHREE() {
      const {loadstate, loadinfo, rangeblock} = SNLB('three', true);
      loadinfo.textContent = 'Loading the three@0.174.0.js module...';
      const module = await import('//unpkg.com/three@0.174.0/build/three.module.min.js');
      try {
        window.THREE = module;
        loadinfo.textContent = 'The three@0.174.0.js module is loaded successfully!';
        rangeblock.style.width = '100%';
        loadstate.style.backgroundColor = '#fff6';
        setTimeout(() => {
          loadMcPanorama();
        }, 500)
      }catch (e) {
        loadinfo.textContent = 'Failed to load the three.js module!';
        rangeblock.style.width = '0%';
      }
    }
    loadTHREE();
    //create()
  </script>
  <audio id="Playmusic"></audio>
  <section>
    <main id="title" class="unselectable">
      <div style="position: relative;">
        <img class="logo" src="./assets/page/Global-Header_MCCB-Logo_300x51.svg" alt="logo"/>
        <span class="ooops"><a href="https://github.com/Domdkw/MC-Panorama">https://github.com/Domdkw/MC-Panorama</a></span>
      </div>
      <div class="btn-area">
        <div class="all">
          <button id="create" onclick="create()"><span class="goggles"></span>机械动力：思索</button>
          <button id="server" onclick="server(true)">服务器</button>
          <button id="options" onclick="options.show();">选项</button>
        </div>
        <div class="half">
          <button id="home_page" onclick="cd('\/\/www.prcooker.asia', null)">主页</button>
          <div class="sound_range_div">
            <div>            
              <span id="bg_music_text">音乐：</span>
              <span id="sound_state">off</span></di>
            </div>
            <input type="range" id="volume_slider" min="0" max="1" step="0.01" value="0">
          </div>
          <button id="lang_btn" title="language语言" onclick="showlang()"><img src="./assets/page/lang-ico.png" alt="lang-ico"></button>
        </div>
      </div>
    </main>
    <section id="lang-div" class="abso dirt unselectable">
      <span id="lang_title" class="detailed-title">选择语言</span>
      <hr class="lang-hr">
      <div class="language-list bt-scroll">
        <span id="lang-unknown">(unknown)</span>
        <span id="zh-CN">简体中文</span>
        <span id="zh-TW">繁體中文（中国台湾）</span>
        <span id="en-US">English</span>
      </div>
      <hr class="lang-hr">
      <div class="lang-btn-half">
        <button onclick="unicode()"><span id="Use_Unicode_fonts">使用Unicode字体：</span><span id="ttf-state">off</span></button>
        <button id="lang_done" onclick="hiddenlang()">完成</button>
      </div>
    </section>
    <section id="server-page" class="abso dirt">
      <div class="sv_title">服务器列表</div>
      <div class="sv-div">
        <div class="sv-list bt-scroll">
          <div class="sv-item" data-server-ip="play.simpfun.cn:19533">
            <img class="sv-title-img" src="./assets/server/lyf 2024.43.43.png" alt="服务器图片">
            <div class="sv-item-info">
              <p style="font-size: large;">lyf 2024.43.43</p>
              <p class="sv-description" style="color: #eee8;"></p>
            </div>
            <div class="sv-item-state">
              <div class="sv-item-online">
                <span class="player-state">
                </span>
                <div class="sv-state-img"></div>
              </div>
            </div>
          </div><!--card-->
          <div class="sv-item" data-server-ip="mc.catserver.moe">
            <img class="sv-title-img" src="" alt="服务器图片">
            <div class="sv-item-info">
              <p style="font-size: large;">神必猫猫</p>
              <p class="sv-description" style="color: #eee8;"></p>
            </div>
            <div class="sv-item-state">
              <div class="sv-item-online">
                <span class="player-state">
                </span>
                <div class="sv-state-img"></div>
              </div>
            </div>
          </div><!--card-->
        </div>
      </div>
      <div class="btn-area">
        <button id="sv_back" onclick="server(false)">返回</button>
        <button id="sv_refresh" onclick="refreshsv()">刷新</button>
        <button id="copy_svlink">复制链接地址</button>
        <button id="sv_det">详细信息</button>
      </div>
    </section>
    <section id="options-page" class="abso dirt unselectable">
      <div class="tab-container">
        <button class="tab active canClick">通用</button>
        <button class="tab disabled canClick">Quality</button>
        <button class="tab done canClick" onclick="options.hide();options.save()">完成</button>
      </div>
      <div class="settings-container bt-scroll">
        <div id="sti-imgMirror" class="setting-item range" data-type="range">
          <span class="setting-label">全景图镜像源</span>
          <span class="setting-remind">*加快拉取速度。*Github可能无法访问，postimg移动网络受限制</span>
          <input class="canClick" type="range" min="0" max="4" step="1" value="4">
          <span class="setting-value">Auto自动</span>
        </div>
        <div id="sti-moreooops" class="setting-item checkbox" data-type="checkbox">
            <span class="setting-label">启用更多ooops信息</span>
            <label class="canClick"><input class="canClick" type="checkbox"></label>
        </div>
        <div id="sti-ooops-source" class="setting-item chd disabled" data-type="select">
          <span class="setting-label">--ooops信息来源</span>
          <span class="setting-remind">*中国大陆推荐使用Gitee，其他地区推荐使用Github</span>
          <select name="ooops-source" disabled>
            <option value="gitee" selected>Cloudflare Pages</option>
          </select>
        </div>
        <hr>
        <div class="sti-LS-div setting-child sti-LS-info-sti">
          <button class="sti-LS-info-btn tab canClick" onclick="options.btn.showLSInfoSti()">查看LocalStorage.sti信息</button>
        </div>
        <div class="sti-LS-div setting-child sti-LS-info-all">
          <button class="sti-LS-info-btn tab canClick" onclick="options.btn.showLSInfoAll()">查看所有LocalStorage信息</button>
        </div>
        <div class="sti-LS-div setting-child sti-LS-clean-sti">
          <button class="sti-LS-info-btn tab canClick" onclick="options.btn.cleanLS()">清除LocalStorage.sti信息</button>
        </div>
        <div class="sti-LS-div setting-child sti-LS-clean-all">
          <button class="sti-LS-info-btn tab canClick" onclick="options.btn.cleanAllLS()">清除所有LocalStorage信息</button>
        </div>
      </div>
    </section>  
  </section>
  <section id="cd-page" class="abso dirt">
    <div class="cd-main">
      <div class="cd-title">
        <span id="cd_text_info">这指向一个网页链接，不能确定其安全性，是否进行跳转？</span>
        <a id="cd_text_link" style="color: #2530ff;"></a>
      </div>
      <div class="cd-buttons">
        <button id="openurl">打开此网站</button>
        <button id="urlcopy">复制到剪贴板</button>
        <button id="urlcancel" onclick="cd(false)">取消</button>
      </div>
    </div>
  </section>
  <section id="option-LS" class="abso dirt unselectable">
    <div class="oLA-container">
      <div class="oLA-info">
        <div id="oLA-text"></div>
      </div>
      <div class="oLA-btn-area">
        <button id="oLA-cancel-Btn">取消</button>
        <button id="oLA-accept-Btn">启用</button>
      </div>
    </div>
  </section>
  <script type="text/javascript" src="mc-background.js"></script>
  <script type="text/javascript" src="playsound.js"></script>
  <script src="page.js"></script>
</body>
</html>
